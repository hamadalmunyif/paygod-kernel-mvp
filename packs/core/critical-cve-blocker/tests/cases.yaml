version: "1.0.0"
cases:
  - name: "Deny Critical CVE"
    description: "Should block artifacts with CVSS score >= 9.0"
    input:
      scan_report:
        artifact_name: "payment-service:v1.2.3"
        vulnerabilities:
          - cve_id: "CVE-2023-1234"
            severity: "CRITICAL"
            cvss_score: 9.8
            status: "active"
    expected:
      decision: "deny"
      matchers:
        - field: "reason"
          operator: "contains"
          value: "unpatched critical vulnerabilities"

  - name: "Warn High CVE"
    description: "Should warn on artifacts with CVSS score between 7.0 and 9.0"
    input:
      scan_report:
        artifact_name: "frontend-app:v2.0.0"
        vulnerabilities:
          - cve_id: "CVE-2023-5678"
            severity: "HIGH"
            cvss_score: 7.5
            status: "active"
    expected:
      decision: "flag"
      matchers:
        - field: "reason"
          operator: "contains"
          value: "high severity vulnerabilities"

  - name: "Allow Clean Artifact"
    description: "Should allow artifacts with no high/critical vulnerabilities"
    input:
      scan_report:
        artifact_name: "safe-lib:v1.0.1"
        vulnerabilities:
          - cve_id: "CVE-2023-9999"
            severity: "LOW"
            cvss_score: 3.2
            status: "active"
    expected:
      decision: "allow"
